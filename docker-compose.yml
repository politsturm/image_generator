# Общая конфигурация docker-compose для основного приложения

version: '3.3'
services:
  nginx:
    image: nginx:1.15.6-alpine
    volumes:
    - ./etc/docker/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    - ./etc/docker/nginx/conf.d/default.conf:/etc/nginx/conf.d/default.conf
    - .:/var/www
    working_dir: /var/www
    restart: always
    depends_on:
      - php
    networks:
      default:
        aliases:
          - image_generator_nginx
    ports:
    - "8021:80"
  php:
    image: php:7.2.12-fpm-alpine3.8
    user: "${USER_UID}:0"
    volumes:
    - ./etc/docker/php/php.ini:/usr/local/etc/php/php.ini:ro
    - ./etc/docker/php/php-fpm.d/www.conf:/usr/local/etc/php-fpm.d/www.conf:ro
    - .:/var/www
    working_dir: /var/www
    restart: always
    cap_add:
      - SYS_PTRACE
    networks:
      default:
        aliases:
        - image_generator_php
